---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import FeaturedPost from '../components/FeaturedPost.astro';
import PostCard from '../components/PostCard.astro';
import GetStartedCTA from '../components/GetStartedCTA.astro';
import WatchLearn from '../components/WatchLearn.astro';
import TrailheadSection from '../components/TrailheadSection.astro';

// Get all posts sorted by date
const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

// Featured post is the most recent
const featuredPost = posts[0];
// Remaining posts for the grid
const gridPosts = posts.slice(1);
---

<BaseLayout title="Agentforce Vibes">
  <Hero 
    title="Agentforce Vibes" 
    description="Exploring the future of AI agents, automation, and the evolving landscape of enterprise technology. Join us as we dive deep into agentic AI and what it means for how we work."
  />
  
  {featuredPost && <FeaturedPost post={featuredPost} />}
  
  {gridPosts.length > 0 && (
    <section class="posts-section">
      <div class="container">
        <div class="posts-section__header">
          <h2 class="posts-section__title">Latest Articles</h2>
        </div>
        <div class="posts-grid">
          {gridPosts.map((post) => (
            <PostCard post={post} />
          ))}
        </div>
      </div>
    </section>
  )}
  
  <GetStartedCTA />
  
  <WatchLearn />
  
  <TrailheadSection />
</BaseLayout>
